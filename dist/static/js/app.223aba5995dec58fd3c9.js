webpackJsonp([1],{"+wW2":function(t,o){},"8yqA":function(t,o){},CHx6:function(t,o){},NHnr:function(t,o,i){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var e=i("7+uW"),n=i("zL8q"),s=i.n(n),l=(i("tvR6"),{render:function(){var t=this.$createElement,o=this._self._c||t;return o("div",{attrs:{id:"app"}},[o("router-view")],1)},staticRenderFns:[]});var r=i("VU/8")({name:"App"},l,!1,function(t){i("8yqA")},null,null).exports,c=i("/ocq"),u={name:"Inside",data:function(){return{button_click:[],timer:null,running:!1,going_up:!0,door:!1,current_floor:1,max_floor:20,min_floor:1,floor_id:[],outside_up:[],outside_down:[],inside:[],call:[]}},props:{ele_id:Number,floor_count:Number,call_ele_id:Number,press_floor:Number,up:Boolean,down:Boolean},methods:{handlePhoneClick:function(){alert("☎️请求通话！☎️")},handleBellClick:function(){alert("🆘请求支援!🆘")},updateFloorInfo:function(){this.$emit("childStatus",this.ele_id,this.current_floor,this.running,this.call,this.going_up)},handleInsideButtonClick:function(t){this.button_click[t]=!0,this.inside[t]=1,console.log("内部按键对列我康康",this.inside),this.dial(t)},outsideButtonClick:function(t){this.outside[t]=1,this.dial(t)},dial:function(t){console.log("现在按下第几层？",t),this.call.push(t),this.call.sort(),console.log("现在的队列是：",this.call),this.running||this.checkStatus()},getMinInQueue:function(t){if(t.length<=0)return console.log("找不到最小值"),!1;if(1==t.length)return t[0];var o=t[0];for(var i in t)t[i]<o&&(o=t[i]);return o},getMaxInQueue:function(t){if(t.length<=0)return console.log("找不到最大值"),!1;if(1==t.length)return t[0];var o=t[0];for(var i in t)t[i]>o&&(o=t[i]);return o},removeFromQueue:function(t,o){console.log("要删除的数字是："+o);var i=t.indexOf(o);i>-1&&t.splice(i,1)},openDoor:function(){this.door=!0},closeDoor:function(){this.door=!1,console.log("door closed")},doorAlert:function(){this.running&&0==this.door&&(alert("运行期间禁止开门！"),this.door=!1)},checkStatus:function(){this.running=this.call.length>0,this.current_floor==this.min_floor?this.going_up=!0:this.current_floor==this.max_floor?this.going_up=!1:(this.going_up&&(!this.running||this.current_floor<=this.getMaxInQueue(this.call))?this.going_up=!0:this.going_up=!1,this.going_up||this.running&&!(this.current_floor>=this.getMinInQueue(this.call))?this.going_up=!0:this.going_up=!1,console.log(this.getMaxInQueue(this.call),this.going_up))},addOutside:function(t,o,i){console.log("父组件触发我了,我是电梯",this.ele_id),console.log("现在按下第几层？",i),1==t?(console.log("按下了向上按键"),this.outside_up[i]=1):1==o&&(console.log("按下了向下按键"),this.outside_down[i]=1),this.dial(i)},run:function(){var t=!1;this.running&&(this.call.indexOf(this.current_floor)>-1?(1==this.inside[this.current_floor]&&(this.removeFromQueue(this.call,this.current_floor),this.inside[this.current_floor]=0,this.button_click[this.current_floor]=0,t=!0),this.going_up?(1==this.outside_up[this.current_floor]&&(console.log("到达外面呼叫：",this.current_floor),this.removeFromQueue(this.call,this.current_floor),this.outside_up[this.current_floor]=0,t=!0),1==this.outside_down[this.current_floor]&&this.current_floor==this.getMaxInQueue(this.call)&&(this.removeFromQueue(this.call,this.current_floor),outside_down[this.current_floor]=0,t=!0)):(1==this.outside_down[this.current_floor]&&(this.removeFromQueue(this.call,this.current_floor),this.outside_down[this.current_floor]=0,t=!0),1==this.outside_up[this.current_floor]&&this.current_floor==this.getMinInQueue(this.call)&&(this.removeFromQueue(this.call,this.current_floor),this.outside_up[this.current_floor]=0,t=!0)),t?(console.log("stop:",this.current_floor),this.ding(this.current_floor)):this.going_up?this.moveUp():this.moveDown()):(this.going_up?this.moveUp():this.moveDown(),this.updateFloorInfo()),this.checkStatus())},ding:function(t){var o=this,i=this;this.timer&&clearInterval(this.timer),this.openDoor(),setTimeout(function(){o.closeDoor(),setTimeout(function(){i.timer=setInterval(i.run,1e3)},3e3)},4e3)},moveUp:function(){this.current_floor<this.max_floor&&this.current_floor++},moveDown:function(){this.current_floor>this.min_floor&&this.current_floor--}},created:function(){for(var t=0;t<=this.max_floor;++t)this.button_click[t]=!1,this.outside_up[t]=0,this.outside_down[t]=0,this.inside[t]=0,this.floor_id[t]=t},mounted:function(){this.timer=setInterval(this.run,1e3)},destroyed:function(){clearInterval(this.timer)}},a={render:function(){var t=this,o=t.$createElement,i=t._self._c||o;return i("div",{staticClass:"box"},[i("el-card",{staticClass:"box-card"},[i("el-card",{staticClass:"floor-num",attrs:{shadow:"always"}},[i("div",[i("i",{directives:[{name:"show",rawName:"v-show",value:this.going_up,expression:"this.going_up"}],staticClass:"el-icon-caret-top"}),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:!this.going_up,expression:"!this.going_up"}],staticClass:"el-icon-caret-top disabled"}),t._v("\n                "+t._s(this.current_floor)+"\n                "),i("i",{directives:[{name:"show",rawName:"v-show",value:!this.going_up,expression:"!this.going_up"}],staticClass:"el-icon-caret-bottom"}),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:this.going_up,expression:"this.going_up"}],staticClass:"el-icon-caret-bottom disabled"})])]),t._v(" "),i("div",{staticClass:"button-group"},t._l(this.floor_count,function(o){return i("div",{key:o,staticClass:"button-place"},[i("el-button",{staticClass:"button",class:{"button-click":t.button_click[o]},attrs:{type:"primary",plain:""},on:{click:function(i){return t.handleInsideButtonClick(o)}}},[t._v("\n                    "+t._s(o)+"\n                ")])],1)}),0),t._v(" "),i("div",{staticClass:"control"},[i("el-switch",{staticClass:"switch",staticStyle:{display:"block"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"开门","inactive-text":"关门"},nativeOn:{click:function(o){return t.doorAlert()}},model:{value:t.door,callback:function(o){t.door=o},expression:"door"}}),t._v(" "),i("el-button",{attrs:{type:"warning",icon:"el-icon-phone",circle:""},on:{click:function(o){return t.handlePhoneClick()}}}),t._v(" "),i("el-button",{attrs:{type:"danger",icon:"el-icon-message-solid",circle:""},on:{click:function(o){return t.handleBellClick()}}})],1)],1)],1)},staticRenderFns:[]};var h=i("VU/8")(u,a,!1,function(t){i("CHx6")},"data-v-5dc08544",null).exports,_={name:"Outside",props:{floor_id:Number},data:function(){return{up:!1,down:!1}},methods:{handleUpClick:function(){this.up||(this.up=!0,this.$emit("childCallFloorUp",this.floor_id))},handleDownClick:function(){this.down||(this.down=!0,this.$emit("childCallFloorDown",this.floor_id))}}},d={render:function(){var t=this,o=t.$createElement,i=t._self._c||o;return i("div",[i("div",[i("el-tag",{staticClass:"number-tag"},[t._v(t._s(this.floor_id))]),t._v(" "),i("el-button-group",[i("el-button",{class:{"button-click":this.up},attrs:{size:"small",type:"primary"},on:{click:function(o){return t.handleUpClick()}}},[i("i",{staticClass:"el-icon-top"})]),t._v(" "),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(o){return t.handleDownClick()}}},[i("i",{staticClass:"el-icon-bottom"})])],1)],1)])},staticRenderFns:[]};var f={name:"Home",components:{Inside:h,Outside:i("VU/8")(_,d,!1,function(t){i("+wW2")},null,null).exports},data:function(){return{ele_count:5,floor_count:20,running:[],going_up:[],current_floor:[],call:[[]],press_floor:null,call_ele_id:1,up:!1,down:!1}},methods:{betweenCount:function(t,o,i){if(t>o){var e=t;t=o,o=e}console.log(this.call[i]);var n=[];for(var s in this.call[i])this.call[i][s]<=o&&this.call[i][s]>=t&&n.indexOf(this.call[i][s]<0)&&n.push(this.call[i][s]);return console.log("between:",n.length),n.length},getMinInQueue:function(t){return t[0]},getMaxInQueue:function(t){return t[t.length-1]},calculateUpDistance:function(t){for(var o=2*this.floor_count,i=0,e=1,n=0;n<this.ele_count;n++)if(this.running[n]){var s=this.getMinInQueue(this.call[n]),l=this.getMaxInQueue(this.call[n]);this.current_floor[n]<=t?this.going_up[n]?(console.log("电梯向上，按键比当前高"),i=t-this.current_floor[n]+5*this.betweenCount(t,this.current_floor[n],n)):(console.log("电梯向下，按键比当前高"),i=this.current_floor[n]-s+t-s+5*this.betweenCount(s,t,n)):this.going_up[n]?(console.log("电梯向上，按键比当前低"),i=l-this.current_floor[n]+l-s+Math.abs(s-t)+5*this.betweenCount(o,l,n),console.log("distance:",i,"max:",o)):(console.log("电梯向下，按键比当前低"),i=this.current_floor[n]-s+Math.abs(s-t)+5*betweenCount(this.current_floor[n],s,n)),i<o&&(o=i,e=n+1)}else i=Math.abs(t-this.current_floor[n]);return console.log(t+"上楼将要放入第"+e+"电梯"),this.up=!0,e},calculateDownDistance:function(t){for(var o=2*this.floor_count,i=0,e=1,n=0;n<this.ele_count;n++)if(this.running[n]){var s=this.getMinInQueue(this.call[n]),l=this.getMaxInQueue(this.call[n]);this.current_floor[n]<=t?this.going_up[n]?(console.log("电梯向上，按键比当前高"),i=l-this.current_floor[n]+Math.abs(l-t)+5*this.betweenCount(this.current_floor[n],l,n)):(console.log("电梯向下，按键比当前高"),i=this.current_floor[n]-s+l-s+Math.abs(l-t)+5*this.betweenCount(o,l,n)):this.going_up[n]?(console.log("电梯向上，按键比当前低"),i=l-this.current_floor[n]+l-t+5*this.betweenCount(l,t,n),console.log("distance:",i,"max:",o)):(console.log("电梯向下，按键比当前低"),i=this.current_floor[n]-t+5*betweenCount(t,this.current_floor[n],n)),i<o&&(o=i,e=n+1)}else i=Math.abs(t-this.current_floor[n]);return console.log(t+"下楼将要放入第"+e+"电梯"),this.down=!0,e},callFloorUp:function(t){this.press_floor=t,this.call_ele_id=this.calculateUpDistance(t),this.$refs.insidechild[this.call_ele_id-1].addOutside(this.up,this.down,t),console.log("传入第几个电梯：",this.call_ele_id,"第几层楼",this.press_floor);for(var o=0;o<this.ele_count;o++)console.log("call:",this.call[o])},callFloorDown:function(t){this.press_floor=t,this.call_ele_id=this.calculateDownDistance(t),this.$refs.insidechild[this.call_ele_id-1].addOutside(this.up,this.down,t),console.log("传入第几个电梯：",this.call_ele_id,"第几层楼",this.press_floor);for(var o=0;o<this.ele_count;o++)console.log("call:",this.call[o])},getChildStatus:function(t,o,i,e,n){this.current_floor[t-1]=o,this.running[t-1]=i,this.call[t-1]=e,this.going_up[t-1]=n,console.log("ele_id:",t)}},created:function(){for(var t=0;t<this.ele_count;++t)this.running[t]=!1,this.current_floor[t]=1}},g={render:function(){var t=this,o=t.$createElement,i=t._self._c||o;return i("div",{staticClass:"page"},[i("div",t._l(this.ele_count,function(o){return i("inside",{key:o,ref:"insidechild",refInFor:!0,staticClass:"card",attrs:{floor_count:t.floor_count,ele_id:o,press_floor:t.press_floor,up:t.up,down:t.down,call_ele_id:t.call_ele_id},on:{childStatus:t.getChildStatus}})}),1),t._v(" "),i("div",t._l(this.floor_count,function(o){return i("outside",{key:o,staticClass:"floor",attrs:{floor_id:o},on:{childCallFloorUp:t.callFloorUp,childCallFloorDown:t.callFloorDown}})}),1)])},staticRenderFns:[]};var p=i("VU/8")(f,g,!1,function(t){i("qAn/")},null,null).exports;e.default.use(c.a);var v=new c.a({routes:[{path:"/",name:"Home",component:p}]});e.default.use(s.a),e.default.config.productionTip=!1,new e.default({el:"#app",router:v,components:{App:r},template:"<App/>"})},"qAn/":function(t,o){},tvR6:function(t,o){}},["NHnr"]);
//# sourceMappingURL=app.223aba5995dec58fd3c9.js.map